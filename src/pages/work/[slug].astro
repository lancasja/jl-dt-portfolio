---
import works from "@/collections/works.json";
import PageHeader from "@/components/elements/PageHeader.astro";
import SeparatorLine from "@/components/elements/SeparatorLine.astro";
import PostLayout from "@/layouts/PostLayout.astro";

interface Work {
	name: string;
	slug: string;
	description?: string;
	image: string;
	url?: string;
	tags?: string[];
	video?: string;
	isShow?: boolean;
}

export function getStaticPaths() {
	const allWorks = works as Work[];
	return allWorks
		.filter((work) => work.slug)
		.map((work) => ({
			params: { slug: work.slug },
			props: { work },
		}));
}

const { work } = Astro.props as { work: Work };

if (!work) {
	return Astro.redirect("/404");
}

const keywords = work.tags ? work.tags.join(", ") : "";
---

<PostLayout
	title={work.name}
	description={work.description}
	keywords={keywords}
>
	<div class="work article">
		<main class="work-wrapper">
			<PageHeader
				title={work.name}
				tags={work.tags}
				className="mb-6 md:mb-8"
			/>
			<div class="site-container m-auto">
				<SeparatorLine />
			</div>
			<section class="article-content">
				<div class="site-container mx-auto my-8 md:my-16">
					<!-- Hero image -->
					<picture class="picture mb-8 md:mb-12 rounded-2xl overflow-hidden block">
						<img
							src={work.image}
							alt={work.name}
							class="w-full h-full object-cover"
							loading="eager"
						/>
					</picture>

					<!-- Description -->
					{work.description && (
						<div class="prose prose-lg dark:prose-invert max-w-none">
							<p class="text-neutral-700 dark:text-neutral-300 leading-relaxed text-lg">
								{work.description}
							</p>
						</div>
					)}

					<!-- External link -->
					{work.url && (
						<div class="mt-8">
							<a
								href={work.url}
								target="_blank"
								rel="noopener noreferrer"
								class="inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-xl hover:bg-primary/90 transition-colors"
							>
								Visit Project
								<svg
									xmlns="http://www.w3.org/2000/svg"
									width="16"
									height="16"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								>
									<path d="M7 7h10v10"></path>
									<path d="M7 17 17 7"></path>
								</svg>
							</a>
						</div>
					)}

					<!-- Back link -->
					<div class="mt-12 pt-8 border-t border-neutral-200 dark:border-neutral-700">
						<a
							href="/works"
							class="inline-flex items-center gap-2 text-neutral-600 dark:text-neutral-400 hover:text-primary dark:hover:text-primary-light transition-colors"
						>
							<svg
								xmlns="http://www.w3.org/2000/svg"
								width="16"
								height="16"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="2"
								stroke-linecap="round"
								stroke-linejoin="round"
							>
								<path d="m15 18-6-6 6-6"></path>
							</svg>
							Back to Projects
						</a>
					</div>
				</div>
			</section>
		</main>
	</div>
</PostLayout>
